<!doctype html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>AITRICS 2026 Dr.Answer 3.0 | Master Roadmap</title>

    <style>
      @import url("https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@500;800&family=Pretendard:wght@400;600;800&display=swap");

      :root {
        --bg: #030406;
        --surface: #0b0d12;
        --border: #1e222d;
        --text-p: #f8fafc;
        --text-s: #94a3b8;
        --data: #00d1ff;
        --ai: #a855f7;
        --svc: #f43f5e;
        --reg: #fbbf24;
        --done: #10b981;
        --danger: #fb7185;
        --radius: 16px;
      }
      * {
        box-sizing: border-box;
      }
      body {
        font-family:
          "Pretendard",
          system-ui,
          -apple-system,
          Segoe UI,
          Roboto,
          "Noto Sans KR",
          sans-serif;
        background: var(--bg);
        color: var(--text-p);
        margin: 0;
        padding: 26px;
      }
      .container {
        max-width: 1760px;
        margin: 0 auto;
      }
      header {
        display: flex;
        justify-content: space-between;
        align-items: flex-end;
        gap: 14px;
        margin-bottom: 14px;
        border-bottom: 1px solid var(--border);
        padding-bottom: 14px;
      }
      .h-title {
        margin: 0;
        font-size: 22px;
        letter-spacing: 0.2px;
      }
      .h-sub {
        margin: 6px 0 0 0;
        color: var(--text-s);
        font-size: 13px;
      }
      .right-stack {
        display: flex;
        flex-direction: column;
        align-items: flex-end;
        gap: 10px;
      }
      .total-stat {
        text-align: right;
      }
      .total-label {
        font-size: 12px;
        color: var(--text-s);
        font-weight: 800;
        letter-spacing: 1px;
        display: flex;
        align-items: center;
        gap: 8px;
        justify-content: flex-end;
      }
      .total-percent {
        font-family: "JetBrains Mono";
        font-size: 40px;
        font-weight: 800;
        color: var(--data);
      }
      .top-actions {
        display: flex;
        gap: 8px;
        align-items: center;
      }
      .btn {
        border: 1px solid var(--border);
        background: rgba(255, 255, 255, 0.02);
        color: var(--text-p);
        border-radius: 10px;
        padding: 8px 10px;
        font-size: 12px;
        font-weight: 900;
        cursor: pointer;
      }
      .btn:hover {
        background: rgba(255, 255, 255, 0.04);
      }
      .btn.primary {
        border-color: rgba(56, 189, 248, 0.25);
      }
      .btn.danger {
        border-color: rgba(251, 113, 133, 0.35);
      }
      .badge {
        font-family: "JetBrains Mono";
        font-size: 10px;
        font-weight: 900;
        padding: 3px 7px;
        border-radius: 999px;
        border: 1px solid rgba(255, 255, 255, 0.12);
        background: #161b22;
        color: var(--text-s);
      }
      .badge.on {
        color: #001b12;
        background: rgba(16, 185, 129, 0.12);
        border-color: rgba(16, 185, 129, 0.35);
      }

      /* Big tabs (ìš”ì²­ëŒ€ë¡œ 4ê°œ ìœ ì§€) */
      .nav {
        display: flex;
        flex-wrap: wrap;
        gap: 8px;
        margin: 12px 0 16px 0;
      }
      .nav a {
        text-decoration: none;
        color: var(--text-p);
        border: 1px solid var(--border);
        background: rgba(255, 255, 255, 0.02);
        padding: 8px 10px;
        border-radius: 10px;
        font-size: 12px;
        font-weight: 900;
      }
      .nav a:hover {
        background: rgba(255, 255, 255, 0.04);
      }

      .section-title {
        font-size: 14px;
        font-weight: 900;
        color: var(--text-s);
        margin: 18px 0 10px 0;
        letter-spacing: 1px;
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .card {
        background: var(--surface);
        border: 1px solid var(--border);
        border-radius: var(--radius);
        padding: 16px;
        margin-bottom: 14px;
      }

      /* ===== 4 Category Progress Overview (ìƒë‹¨ ê³ ì • ì§„í–‰í˜„í™©) ===== */
      .grid-4 {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: 10px;
      }
      .p-card {
        background: rgba(255, 255, 255, 0.02);
        border: 1px solid var(--border);
        border-radius: 14px;
        padding: 12px;
      }
      .p-top {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        gap: 10px;
      }
      .p-name {
        font-size: 12.5px;
        font-weight: 900;
      }
      .p-meta {
        font-family: "JetBrains Mono";
        font-size: 11px;
        color: var(--text-s);
        text-align: right;
        white-space: nowrap;
      }
      .p-bar {
        margin-top: 10px;
        height: 10px;
        border-radius: 999px;
        overflow: hidden;
        background: rgba(255, 255, 255, 0.06);
        border: 1px solid rgba(255, 255, 255, 0.06);
      }
      .p-fill {
        height: 100%;
      }
      .p-foot {
        margin-top: 10px;
        display: flex;
        justify-content: space-between;
        gap: 10px;
        align-items: center;
      }
      .pill {
        font-family: "JetBrains Mono";
        font-size: 10px;
        font-weight: 900;
        padding: 3px 7px;
        border-radius: 999px;
        border: 1px solid rgba(255, 255, 255, 0.12);
        background: #161b22;
        color: var(--text-s);
      }

      @media (max-width: 1200px) {
        .grid-4 {
          grid-template-columns: repeat(2, 1fr);
        }
      }
      @media (max-width: 760px) {
        .grid-4 {
          grid-template-columns: 1fr;
        }
        body {
          padding: 16px;
        }
        header {
          align-items: flex-start;
        }
        .right-stack {
          align-items: flex-start;
        }
        .total-stat {
          text-align: left;
        }
        .total-label {
          justify-content: flex-start;
        }
      }

      /* ===== KPI Snapshot ===== */
      .grid-3 {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 10px;
      }
      .kpi {
        background: rgba(255, 255, 255, 0.02);
        border: 1px solid var(--border);
        border-radius: 14px;
        padding: 12px;
      }
      .kpi .k-top {
        display: flex;
        justify-content: space-between;
        gap: 10px;
        align-items: flex-start;
      }
      .kpi .k-name {
        font-size: 12.5px;
        font-weight: 900;
      }
      .kpi .k-meta {
        font-family: "JetBrains Mono";
        font-size: 11px;
        color: var(--text-s);
        text-align: right;
      }
      .kpi .k-bar {
        margin-top: 10px;
        height: 10px;
        border-radius: 999px;
        overflow: hidden;
        background: rgba(255, 255, 255, 0.06);
        border: 1px solid rgba(255, 255, 255, 0.06);
      }
      .kpi .k-fill {
        height: 100%;
      }
      .kpi .k-foot {
        margin-top: 10px;
        display: flex;
        justify-content: space-between;
        gap: 10px;
        align-items: center;
      }
      @media (max-width: 1200px) {
        .grid-3 {
          grid-template-columns: 1fr;
        }
      }

      .warn {
        display: flex;
        gap: 10px;
        align-items: flex-start;
        border: 1px solid rgba(251, 191, 36, 0.25);
        background: rgba(251, 191, 36, 0.06);
        padding: 12px;
        border-radius: 12px;
        margin-top: 12px;
      }
      .warn b {
        color: var(--reg);
      }
      .note {
        font-size: 11.5px;
        color: var(--text-s);
        line-height: 1.55;
      }

      /* ===== Timeline ===== */
      .timeline-card {
        overflow-x: auto;
      }
      .gantt-table {
        width: 100%;
        border-collapse: collapse;
        min-width: 1050px;
      }
      .gantt-table th {
        padding: 10px;
        font-size: 10px;
        color: var(--text-s);
        border: 1px solid var(--border);
        background: rgba(255, 255, 255, 0.02);
      }
      .gantt-table td {
        height: 48px;
        border: 1px solid var(--border);
        position: relative;
      }
      .quarter-label {
        background: rgba(255, 255, 255, 0.05);
        font-weight: 900;
        font-size: 10px;
        color: var(--text-p);
        text-align: center;
      }
      .bar {
        position: absolute;
        height: 24px;
        border-radius: 6px;
        display: flex;
        align-items: center;
        padding: 0 10px;
        font-size: 10px;
        font-weight: 900;
        color: #000;
        top: 12px;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
      }
      .milestone {
        position: absolute;
        top: -10px;
        font-size: 10px;
        font-weight: 900;
        color: var(--reg);
        border-left: 2px dashed var(--reg);
        padding-left: 6px;
        height: 64px;
        z-index: 5;
        white-space: nowrap;
      }

      /* ===== Filters / Lens ===== */
      .filters {
        display: flex;
        flex-wrap: wrap;
        gap: 8px;
        align-items: center;
        margin: 8px 0 10px 0;
      }
      .seg {
        display: flex;
        border: 1px solid var(--border);
        border-radius: 12px;
        overflow: hidden;
        background: rgba(255, 255, 255, 0.02);
      }
      .seg button {
        border: 0;
        background: transparent;
        color: var(--text-s);
        padding: 8px 10px;
        font-size: 12px;
        font-weight: 900;
        cursor: pointer;
      }
      .seg button.active {
        color: var(--text-p);
        background: rgba(255, 255, 255, 0.06);
      }
      .select,
      .input {
        border: 1px solid var(--border);
        background: rgba(255, 255, 255, 0.02);
        color: var(--text-p);
        border-radius: 10px;
        padding: 8px 10px;
        font-size: 12px;
        font-weight: 800;
        outline: none;
      }
      .chipbar {
        display: flex;
        flex-wrap: wrap;
        gap: 6px;
        align-items: center;
      }
      .chip {
        border: 1px solid rgba(255, 255, 255, 0.12);
        background: rgba(255, 255, 255, 0.02);
        color: var(--text-s);
        border-radius: 999px;
        padding: 6px 10px;
        font-size: 11px;
        font-weight: 900;
        cursor: pointer;
        user-select: none;
      }
      .chip.on {
        color: var(--text-p);
        border-color: rgba(56, 189, 248, 0.25);
        background: rgba(56, 189, 248, 0.08);
      }

      /* ===== WBS Table (í•œ í–‰ì— ìµœëŒ€ í‘œì‹œ) ===== */
      .wbs-wrap {
        overflow-x: auto;
      }
      table.wbs {
        width: 100%;
        min-width: 1320px;
        border-collapse: collapse;
        border: 1px solid var(--border);
        border-radius: 12px;
        overflow: hidden;
        background: rgba(255, 255, 255, 0.01);
      }
      table.wbs th,
      table.wbs td {
        border: 1px solid var(--border);
        padding: 10px;
        font-size: 12px;
        vertical-align: top;
      }
      table.wbs th {
        background: rgba(255, 255, 255, 0.03);
        color: var(--text-s);
        font-weight: 900;
        font-size: 11px;
        letter-spacing: 0.4px;
        text-align: left;
        white-space: nowrap;
      }
      .dept-row td {
        background: rgba(255, 255, 255, 0.02);
        font-weight: 900;
        color: var(--text-p);
        font-size: 12px;
      }
      .dept-tag {
        display: inline-block;
        font-size: 10px;
        font-weight: 900;
        color: #000;
        padding: 3px 8px;
        border-radius: 6px;
        margin-right: 8px;
      }
      .cb {
        width: 18px;
        height: 18px;
        accent-color: var(--done);
        cursor: pointer;
      }
      .mono {
        font-family: "JetBrains Mono";
      }
      .idcell {
        white-space: nowrap;
      }
      .steps {
        color: var(--text-s);
        font-size: 11px;
        line-height: 1.45;
      }
      .stepline {
        display: flex;
        gap: 8px;
        align-items: flex-start;
        margin: 2px 0;
      }
      .wtag {
        font-family: "JetBrains Mono";
        font-size: 10px;
        font-weight: 900;
        padding: 2px 7px;
        border-radius: 999px;
        border: 1px solid rgba(255, 255, 255, 0.12);
        background: rgba(255, 255, 255, 0.03);
        color: var(--text-p);
        white-space: nowrap;
        flex-shrink: 0;
      }
      .outtag {
        display: inline-block;
        border: 1px solid rgba(255, 255, 255, 0.1);
        background: #161b22;
        color: var(--text-s);
        font-size: 10px;
        font-weight: 900;
        padding: 3px 7px;
        border-radius: 8px;
        white-space: nowrap;
      }
      .duetag {
        display: block;
        font-family: "JetBrains Mono";
        font-size: 12px;
        font-weight: 900;
        color: var(--reg);
        white-space: nowrap;
      }
      .duemeta {
        display: block;
        margin-top: 4px;
        font-size: 10.5px;
        color: var(--text-s);
        white-space: nowrap;
      }
      .doneRow {
        background: rgba(16, 185, 129, 0.03);
      }
      .doneText {
        color: var(--done);
        text-decoration: line-through;
        opacity: 0.78;
      }
      .editHint {
        display: none;
        margin-top: 6px;
        font-size: 10.5px;
        color: var(--text-s);
      }
      .editable {
        border-radius: 6px;
        outline: none;
      }
      .editable[contenteditable="true"] {
        padding: 2px 4px;
        border: 1px dashed rgba(56, 189, 248, 0.4);
        background: rgba(56, 189, 248, 0.06);
      }

      /* ===== Reg tables (ê¸°ì¡´ ìœ ì§€) ===== */
      table.dark {
        width: 100%;
        border-collapse: collapse;
        border: 1px solid var(--border);
        border-radius: 12px;
        overflow: hidden;
        background: rgba(255, 255, 255, 0.01);
      }
      table.dark th,
      table.dark td {
        border: 1px solid var(--border);
        padding: 10px;
        font-size: 12px;
        vertical-align: top;
      }
      table.dark th {
        background: rgba(255, 255, 255, 0.03);
        color: var(--text-s);
        font-weight: 900;
        font-size: 11px;
        letter-spacing: 0.4px;
        text-align: left;
      }
      .grid-2 {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 10px;
      }
      @media (max-width: 1200px) {
        .grid-2 {
          grid-template-columns: 1fr;
        }
      }

      /* ===== Minimal modal + toast (íŒì—… ìµœì†Œí™”) ===== */
      .modal-backdrop {
        display: none;
        position: fixed;
        inset: 0;
        background: rgba(0, 0, 0, 0.55);
        align-items: center;
        justify-content: center;
        z-index: 9999;
        padding: 18px;
      }
      .modal {
        width: min(420px, 100%);
        border-radius: 14px;
        border: 1px solid var(--border);
        background: rgba(11, 13, 18, 0.98);
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.55);
        padding: 14px;
      }
      .modal h3 {
        margin: 0 0 8px 0;
        font-size: 13px;
        font-weight: 900;
        color: var(--text-p);
      }
      .modal p {
        margin: 0 0 10px 0;
        font-size: 11.5px;
        color: var(--text-s);
        line-height: 1.55;
      }
      .modal .row {
        display: flex;
        gap: 8px;
        align-items: center;
      }
      .modal .pw {
        flex: 1;
        border: 1px solid var(--border);
        background: rgba(255, 255, 255, 0.02);
        color: var(--text-p);
        border-radius: 10px;
        padding: 9px 10px;
        font-size: 12px;
        font-weight: 900;
        outline: none;
        font-family: "JetBrains Mono";
      }
      .toast-wrap {
        position: fixed;
        bottom: 18px;
        right: 18px;
        display: flex;
        flex-direction: column;
        gap: 8px;
        z-index: 10000;
      }
      .toast {
        border: 1px solid rgba(255, 255, 255, 0.12);
        background: rgba(22, 27, 34, 0.92);
        color: var(--text-p);
        padding: 10px 12px;
        border-radius: 12px;
        font-size: 12px;
        font-weight: 900;
        box-shadow: 0 12px 30px rgba(0, 0, 0, 0.45);
        max-width: 420px;
      }
      .toast.good {
        border-color: rgba(16, 185, 129, 0.35);
        background: rgba(16, 185, 129, 0.1);
      }
      .toast.bad {
        border-color: rgba(251, 113, 133, 0.4);
        background: rgba(251, 113, 133, 0.1);
      }
    </style>
  </head>

  <body>
    <div class="container">
      <header>
        <div>
          <h1 class="h-title">
            AITRICS
            <span style="font-weight: 300">2026 Dr.Answer 3.0 Master</span>
          </h1>
          <p class="h-sub">
            ì—°ê°„-ë°˜ê¸°-ë¶„ê¸°-ì›”-ì£¼ì°¨ í•„í„° ê¸°ë°˜ WBS + ì¸í—ˆê°€ ê¸°ëŠ¥ë¶„ë¦¬/ì œì¶œìë£Œ
            í”„ë ˆì„ í†µí•© ëŒ€ì‹œë³´ë“œ
          </p>
        </div>

        <div class="right-stack">
          <div class="top-actions">
            <span class="badge" id="edit-badge">READ-ONLY</span>
            <button class="btn primary" id="edit-btn">ğŸ”’ í¸ì§‘</button>
            <button class="btn" id="save-btn" style="display: none">
              ì €ì¥
            </button>
            <button class="btn danger" id="exit-btn" style="display: none">
              í¸ì§‘ ì¢…ë£Œ
            </button>
          </div>

          <div class="total-stat">
            <div class="total-label">
              <span>TOTAL PROGRESS</span>
              <span class="badge" id="total-scope">SCOPE: -</span>
            </div>
            <div class="total-percent" id="total-val">0%</div>
          </div>
        </div>
      </header>

      <!-- 4ê°€ì§€ í° íƒ­ ìœ ì§€ -->
      <div class="nav">
        <a href="#kpi">KPI ìŠ¤ëƒ…ìƒ·</a>
        <a href="#timeline">ì „ëµ íƒ€ì„ë¼ì¸</a>
        <a href="#wbs">ì£¼ì°¨ WBS</a>
        <a href="#reg">ê¸°ëŠ¥ë¶„ë¦¬Â·ì¸í—ˆê°€</a>
      </div>

      <!-- ìƒë‹¨ 4ê°œ í•­ëª© ì§„í–‰í˜„í™© í•­ìƒ í‘œì‹œ -->
      <div class="section-title">
        <span>ğŸ“</span> PROGRESS OVERVIEW (4 CATEGORIES)
      </div>
      <div class="card">
        <div class="grid-4" id="overview-grid"></div>
        <div class="note" style="margin-top: 10px">
          ìƒë‹¨ 4ê°œ í•­ëª©ì€ â€œí˜„ì¬ ì„ íƒëœ ê¸°ê°„(ë Œì¦ˆ/ê¸°ê°„)â€ ê¸°ì¤€ìœ¼ë¡œ WBS ì²´í¬ ìƒíƒœë¥¼
          ìë™ ì§‘ê³„í•˜ì—¬ í‘œì‹œí•¨. í¸ì§‘ ëª¨ë“œì—ì„œëŠ” í…ìŠ¤íŠ¸/ë§ˆê°ì£¼ì°¨ ìˆ˜ì • ê°€ëŠ¥í•¨.
        </div>
      </div>

      <!-- KPI Snapshot -->
      <div id="kpi" class="section-title">
        <span>ğŸ“Œ</span> KPI SNAPSHOT (Documented Inputs)
      </div>
      <div class="card">
        <div class="grid-3" id="kpi-grid"></div>
        <div class="warn">
          <div>âš ï¸</div>
          <div class="note">
            <b>ì£¼ì˜ ì‚¬í•­</b><br />
            ë³¸ KPI ìˆ˜ì¹˜ëŠ” â€œì…ë ¥ê°’(ë³´ê³ /ì—…ë°ì´íŠ¸ ë¬¸ì„œ ê¸°ì¤€)â€ìœ¼ë¡œ í‘œì‹œí•¨.<br />
            KPI ì •ì˜(ë¶„ëª¨/ë¶„ì/íŒì •ê¸°ì¤€) ë° ì¦ë¹™ ê²½ë¡œ(íŒŒì¼/ë²„ì „) ì—°ê²° í•„ìš”í•¨.
          </div>
        </div>
      </div>

      <!-- Timeline -->
      <div id="timeline" class="section-title">
        <span>ğŸ—“ï¸</span> STRATEGIC TIMELINE (Q1â€“Q4 2026)
      </div>

      <!-- âœ… Macro Timeline Filter (ìœ„ ë²„ì „ ì•„ì´ë””ì–´ ê²°í•©: ALL/H1/H2/Q1~Q4, WBS ë Œì¦ˆ ìë™ ë™ê¸°í™”) -->
      <div class="card" style="padding: 12px 16px">
        <div class="filters" style="margin: 0">
          <div class="chipbar" id="macro-chips">
            <div class="chip on" data-macro="ALL">ALL</div>
            <div class="chip" data-macro="H1">H1</div>
            <div class="chip" data-macro="H2">H2</div>
            <div class="chip" data-macro="Q1">Q1</div>
            <div class="chip" data-macro="Q2">Q2</div>
            <div class="chip" data-macro="Q3">Q3</div>
            <div class="chip" data-macro="Q4">Q4</div>
          </div>
          <span class="badge" id="macro-view-badge">TIMELINE: ALL</span>
          <span class="note" style="margin: 0"
            >(ì„ íƒ ì‹œ WBS ë Œì¦ˆ/ê¸°ê°„ë„ ìë™ ë™ê¸°í™”)</span
          >
        </div>
      </div>

      <div class="card timeline-card">
        <!-- ê¸°ì¡´ ì •ì  í…Œì´ë¸” â†’ ë™ì  ë Œë”ë§ìœ¼ë¡œ êµì²´ -->
        <div id="macro-timeline"></div>
      </div>

      <!-- WBS -->
      <div id="wbs" class="section-title">
        <span>ğŸ”</span> MICRO-WBS: WEEKLY EXECUTION ITEMS (í•œ í–‰ í‘œì‹œ ì¤‘ì‹¬)
      </div>

      <!-- Lens / Filter controls -->
      <div class="card">
        <div class="filters">
          <div class="seg" aria-label="time lens">
            <button class="active" data-lens="year">ì—°ì°¨</button>
            <button data-lens="half">ë°˜ê¸°</button>
            <button data-lens="quarter">ë¶„ê¸°</button>
            <button data-lens="month">ì›”</button>
            <button data-lens="week">ì£¼</button>
          </div>

          <select class="select" id="period-select" title="ê¸°ê°„ ì„ íƒ"></select>

          <select class="select" id="status-select" title="ìƒíƒœ">
            <option value="all">ì „ì²´</option>
            <option value="open">ë¯¸ì™„ë£Œ</option>
            <option value="done">ì™„ë£Œ</option>
          </select>

          <input
            class="input"
            id="search-input"
            placeholder="ê²€ìƒ‰ (ID/ë‚´ìš©/ì‚°ì¶œë¬¼)"
          />

          <span class="badge" id="count-badge">0 items</span>
          <span class="badge" id="date-badge"></span>
        </div>

        <div class="chipbar" id="dept-chips"></div>

        <div class="note" style="margin-top: 10px">
          ê¸°ê°„ ë Œì¦ˆ(ì—°ì°¨/ë°˜ê¸°/ë¶„ê¸°/ì›”/ì£¼)ë¡œ í•„í„°ë§ ì‹œ, í•´ë‹¹ ê¸°ê°„ì— ì†í•˜ëŠ” DUE
          íƒœìŠ¤í¬ë§Œ ë…¸ì¶œë¨. D-dayëŠ” ë¸Œë¼ìš°ì € ë‚ ì§œ ê¸°ì¤€ ìë™ ê³„ì‚°ë¨.
        </div>
      </div>

      <div class="card wbs-wrap">
        <table class="wbs" id="wbs-table">
          <thead>
            <tr>
              <th style="width: 52px">DONE</th>
              <th style="width: 90px">ID</th>
              <th>ì—…ë¬´(1í–‰)</th>
              <th style="width: 430px">ì£¼ì°¨ë³„ ì„¸ë¶€ ì‹¤í–‰ í•­ëª©</th>
              <th style="width: 150px">DUE (D-â—‹ì¼)</th>
              <th style="width: 120px">ì‚°ì¶œë¬¼</th>
            </tr>
          </thead>
          <tbody id="wbs-body"></tbody>
        </table>
      </div>

      <!-- Regulatory / Function split -->
      <div id="reg" class="section-title">
        <span>ğŸ§¾</span> FUNCTION SPLIT Â· CLASS(1/2) SUBMISSION FRAME
      </div>
      <div class="grid-2">
        <div class="card">
          <div style="font-weight: 900; font-size: 13px; margin-bottom: 10px">
            A. ê¸°ëŠ¥ë¶„ë¦¬(ì˜ë„ëœ ì‚¬ìš©/ì‚¬ìš©ì/í†µì œí¬ì¸íŠ¸) ì´ˆì•ˆ
          </div>
          <table class="dark">
            <thead>
              <tr>
                <th style="width: 18%">ëª¨ë“ˆ</th>
                <th style="width: 18%">ì£¼ ì‚¬ìš©ì</th>
                <th style="width: 18%">ì¶œë ¥ ì„±ê²©</th>
                <th style="width: 23%">ì˜ë£Œì§„ í†µì œ í¬ì¸íŠ¸</th>
                <th style="width: 23%">ë“±ê¸‰ ë¦¬ìŠ¤í¬(ê°€ì •)</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><b>ë°ì´í„° ë³´ê¸°</b><br />Vent/EMR/PRO ë·°ì–´</td>
                <td>ì˜ë£Œì§„Â·ë³´í˜¸ì</td>
                <td>ì›ìë£Œ/ìš”ì•½(ê¸°ìˆ ì )</td>
                <td>í‘œì‹œí•­ëª©Â·ì•ŒëŒ ì„ê³„ì¹˜ ì˜ë£Œì§„ ì„¤ì •</td>
                <td>ë‹¨ìˆœ í‘œì‹œ ë²”ì£¼ ìœ ì§€ ì‹œ ì €ìœ„í—˜ ê°€ëŠ¥ì„±â†‘</td>
              </tr>
              <tr>
                <td><b>ì´ìƒì‹ í˜¸ íƒì§€</b><br />ì‹œê³„ì—´ ëª¨ë¸</td>
                <td>ì˜ë£Œì§„</td>
                <td>Risk score/íŒ¨í„´ í”Œë˜ê·¸</td>
                <td>í™•ì •/ì§„ë‹¨ ë¬¸êµ¬ ê¸ˆì§€, ê·¼ê±° ë¡œê·¸ ì œê³µ</td>
                <td>ì˜ì‚¬ê²°ì • ì§ì ‘ ìœ ë„ ì‹œ ìƒí–¥ ê°€ëŠ¥ì„±</td>
              </tr>
              <tr>
                <td><b>íŠ¸ë¦¬ì•„ì œ</b><br />3ë‹¨ê³„ ë¶„ë¥˜</td>
                <td>ë³´í˜¸ì(ìš°ì„ )</td>
                <td>í–‰ë™ ê¶Œê³ (ì‘ê¸‰/ë‹¹ì¼/ëª¨ë‹ˆí„°)</td>
                <td>ë¬¸êµ¬Â·ê¸°ì¤€ ì˜ë£Œì§„ ìŠ¹ì¸, ê³ ìœ„í—˜ ë³´ìˆ˜ì </td>
                <td>í–‰ë™ ë³€í™” ìœ ë„ ê°•í•¨ â†’ ìƒí–¥ ê°€ëŠ¥ì„±â†‘</td>
              </tr>
              <tr>
                <td><b>ì¼€ì–´ ê°€ì´ë“œ(LLM)</b><br />êµìœ¡Â·ì•ˆë‚´</td>
                <td>ë³´í˜¸ì</td>
                <td>ì¼ë°˜ ì•ˆë‚´/FAQ</td>
                <td>ê²€ìˆ˜ ì»¨í…ì¸ Â·ê¸ˆì¹™ì–´Â·ê°€ë“œë ˆì¼</td>
                <td>ê°œì¸ë§ì¶¤ â€œì²˜ë°©â€ í˜•íƒœ ê¸ˆì§€ í•„ìš”</td>
              </tr>
            </tbody>
          </table>
          <div class="note">
            ë“±ê¸‰ í™•ì •ì€ â€œì˜ë„ëœ ì‚¬ìš©(Indications for Use)Â·ì‚¬ìš©ìÂ·ìœ„í—˜ë„â€ì— ì˜í•´
            ê²°ì •ë¨. íŠ¸ë¦¬ì•„ì œ/ê¶Œê³  í¬í•¨ ì‹œ Class II ìƒí–¥ ê°€ëŠ¥ì„± ì „ì œë¥¼ ê¸°ë³¸ê°’ìœ¼ë¡œ
            ë‘ëŠ” í¸ì´ ë°©ì–´ì ì„.
          </div>
        </div>

        <div class="card">
          <div style="font-weight: 900; font-size: 13px; margin-bottom: 10px">
            B. ì œì¶œìë£Œ ì°¨ë“±(ê°€ì •: Class I vs II) ì²´í¬ë¦¬ìŠ¤íŠ¸
          </div>
          <table class="dark">
            <thead>
              <tr>
                <th style="width: 34%">íŒ¨í‚¤ì§€ í•­ëª©</th>
                <th style="width: 33%">Class I ê°€ì •(ìµœì†Œ)</th>
                <th style="width: 33%">Class II ê°€ì •(ê°•í™”)</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><b>SW ì„¤ëª…</b><br />ì•„í‚¤í…ì²˜/ë²„ì „/ë³€ê²½ì´ë ¥</td>
                <td>ê¸°ëŠ¥ëª©ë¡Â·ì‚¬ìš©í™˜ê²½Â·ë¡œê·¸</td>
                <td>ìƒì„¸ ì•„í‚¤í…ì²˜Â·ë°ì´í„°íë¦„Â·ì¶”ì ì„± ê°•í™”</td>
              </tr>
              <tr>
                <td><b>ìœ„í—˜ê´€ë¦¬</b><br />ìœ í•´ì‚¬ê±´Â·ì™„í™”Â·ì”ì—¬ë¦¬ìŠ¤í¬</td>
                <td>í•µì‹¬ ìœ„í—˜ ì‹œë‚˜ë¦¬ì˜¤ ì¤‘ì‹¬</td>
                <td>íŠ¸ë¦¬ì•„ì œ/ì•ŒëŒ ì¤‘ì‹¬ ì „ìˆ˜í˜• ë¶„ì„ í•„ìš”</td>
              </tr>
              <tr>
                <td><b>ì„ìƒ/ì„±ëŠ¥ ê·¼ê±°</b></td>
                <td>ë‚´ë¶€ ì„±ëŠ¥ + ì œí•œì  ì‚¬ìš©ì í‰ê°€</td>
                <td>ì™¸ë¶€/êµì°¨ê²€ì¦ + ì„ìƒì  ìœ ìš©ì„± ê·¼ê±° ê°•í™”</td>
              </tr>
              <tr>
                <td><b>ì‚¬ì´ë²„ë³´ì•ˆ/SBOM</b></td>
                <td>ê¸°ë³¸ í†µì œ(ì ‘ê·¼ê¶Œí•œ/ì•”í˜¸í™”)</td>
                <td>ìœ„í˜‘ëª¨ë¸Â·ì·¨ì•½ì Â·SBOM ê°•í™” ê°€ëŠ¥ì„±</td>
              </tr>
              <tr>
                <td><b>ì‚¬ìš©ì í•©ì„±</b><br />(ë³´í˜¸ì UI)</td>
                <td>í•µì‹¬ í”Œë¡œìš° ì ê²€</td>
                <td>ì‘ê¸‰ ë¶„ê¸° ì¤‘ì‹¬ ì‚¬ìš©ì„± ê·¼ê±° ê°•í™”</td>
              </tr>
            </tbody>
          </table>
          <div class="warn">
            <div>âš ï¸</div>
            <div class="note">
              â€œClass Ië¡œ ë‹¨ì •â€ì€ ìœ„í—˜í•¨. íŠ¸ë¦¬ì•„ì œ(í–‰ë™ê¶Œê³ ) í¬í•¨ ì‹œ Class II
              ìƒí–¥ ê°€ëŠ¥ì„± ì „ì œ í•„ìš”í•¨.<br />
              í™˜ììš© íŠ¸ë¦¬ì•„ì œì™€ ì˜ë£Œì§„ìš© íŒë‹¨ì§€ì›ì˜ ë¬¸êµ¬/ê¶Œí•œ/ë¡œê·¸ ì„¤ê³„ë¡œ
              ê¸°ëŠ¥ë¶„ë¦¬ ë°©ì–´ ë…¼ë¦¬ êµ¬ì¶• í•„ìš”í•¨.
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- âœ… password modal (prompt ëŒ€ì²´) -->
    <div
      class="modal-backdrop"
      id="pw-backdrop"
      role="dialog"
      aria-modal="true"
      aria-labelledby="pw-title"
    >
      <div class="modal">
        <h3 id="pw-title">í¸ì§‘ ëª¨ë“œ ì§„ì…</h3>
        <p>
          ë¹„ë°€ë²ˆí˜¸(1234) ì…ë ¥ ì‹œ ì¸ë¼ì¸ í¸ì§‘ì´ í™œì„±í™”ë©ë‹ˆë‹¤. (ë¶ˆí•„ìš”í•œ íŒì—…
          ìµœì†Œí™”ë¥¼ ìœ„í•´ ì´ ëª¨ë‹¬ë§Œ ì‚¬ìš©)
        </p>
        <div class="row">
          <input
            class="pw"
            id="pw-input"
            type="password"
            placeholder="PASSWORD"
            autocomplete="off"
          />
          <button class="btn primary" id="pw-ok">í™•ì¸</button>
          <button class="btn danger" id="pw-cancel">ì·¨ì†Œ</button>
        </div>
      </div>
    </div>

    <!-- âœ… toast -->
    <div class="toast-wrap" id="toast-wrap" aria-live="polite"></div>

    <script>
      /* =========================================================
   0) Utilities
========================================================= */
      const YEAR = 2026;
      const STORAGE_KEY = "aitrics_2026_roadmap_v2";
      const EDIT_PASSWORD = "1234";

      function clamp(n, a, b) {
        return Math.max(a, Math.min(b, n));
      }
      function pad2(n) {
        return String(n).padStart(2, "0");
      }
      function fmtDate(d) {
        const y = d.getFullYear(),
          m = pad2(d.getMonth() + 1),
          dd = pad2(d.getDate());
        return `${y}-${m}-${dd}`;
      }
      function parseYMD(ymd) {
        if (!ymd || typeof ymd !== "string") return null;
        const m = ymd.match(/^(\d{4})-(\d{2})-(\d{2})$/);
        if (!m) return null;
        const y = Number(m[1]),
          mo = Number(m[2]),
          da = Number(m[3]);
        const d = new Date(y, mo - 1, da);
        d.setHours(0, 0, 0, 0);
        return d;
      }

      /* ì›”-ì£¼ì°¨(Feb W1) â†’ ë‚ ì§œ(ê¸ˆìš”ì¼ ë§ˆê°) í™˜ì‚° ê·œì¹™
   - í•´ë‹¹ ì›”ì˜ ì²« ë²ˆì§¸ ì›”ìš”ì¼ì„ W1 ì‹œì‘ìœ¼ë¡œ ê°€ì •
   - Wnì˜ ê¸ˆìš”ì¼ì„ ë§ˆê°ì¼ë¡œ ê°€ì • (D-day ê³„ì‚°ìš©)
*/
      const MONTH_MAP = {
        Jan: 1,
        Feb: 2,
        Mar: 3,
        Apr: 4,
        May: 5,
        Jun: 6,
        Jul: 7,
        Aug: 8,
        Sep: 9,
        Oct: 10,
        Nov: 11,
        Dec: 12,
      };

      function firstMondayOfMonth(year, month) {
        const d = new Date(year, month - 1, 1);
        const day = d.getDay(); // 0 Sun ... 1 Mon ... 6 Sat
        const diff = day === 0 ? 1 : day === 1 ? 0 : 8 - day; // days to next Monday
        d.setDate(d.getDate() + diff);
        d.setHours(0, 0, 0, 0);
        return d;
      }
      function dueLabelToDate(dueLabel) {
        // "Feb W1" í˜•íƒœë§Œ ì²˜ë¦¬. ì‹¤íŒ¨ ì‹œ null ë°˜í™˜.
        const m = dueLabel?.match(/^([A-Za-z]{3})\s+W(\d)$/);
        if (!m) return null;
        const mon = MONTH_MAP[m[1]];
        const w = Number(m[2]);
        if (!mon || !w) return null;

        const startMon = firstMondayOfMonth(YEAR, mon);
        const weekStart = new Date(startMon);
        weekStart.setDate(startMon.getDate() + (w - 1) * 7);

        const due = new Date(weekStart);
        due.setDate(weekStart.getDate() + 4); // Friday
        due.setHours(0, 0, 0, 0);
        return due;
      }
      function dDayString(dueDate) {
        if (!dueDate) return "D-?";
        const today = new Date();
        today.setHours(0, 0, 0, 0);
        const due = new Date(dueDate);
        due.setHours(0, 0, 0, 0);
        const diff = Math.round((due - today) / 86400000);
        if (diff >= 0) return `D-${diff}ì¼`;
        return `D+${Math.abs(diff)}ì¼`;
      }

      /* âœ… í”„ë¡œì íŠ¸ íƒ€ì„ë¼ì¸ ê¸°ì¤€(02~12)ìœ¼ë¡œ ë°˜ê¸°/ë¶„ê¸° ì •ì˜ (ê¸°ì¡´ í‘œì™€ ì •í•©) */
      function quarterOfDate(d) {
        const m = d.getMonth() + 1;
        if (m >= 2 && m <= 4) return "Q1"; // 02-04
        if (m >= 5 && m <= 7) return "Q2"; // 05-07
        if (m >= 8 && m <= 10) return "Q3"; // 08-10
        return "Q4"; // 11-12 (ë° ê¸°íƒ€)
      }
      function halfOfDate(d) {
        const m = d.getMonth() + 1;
        if (m >= 2 && m <= 7) return "H1"; // 02-07
        return "H2"; // 08-12
      }
      function monthKey(d) {
        const m = pad2(d.getMonth() + 1);
        return `${YEAR}-${m}`;
      }
      function isoWeek(d) {
        // ISO week number
        const date = new Date(
          Date.UTC(d.getFullYear(), d.getMonth(), d.getDate()),
        );
        const dayNum = date.getUTCDay() || 7;
        date.setUTCDate(date.getUTCDate() + 4 - dayNum);
        const yearStart = new Date(Date.UTC(date.getUTCFullYear(), 0, 1));
        return Math.ceil(((date - yearStart) / 86400000 + 1) / 7);
      }
      function lensKey(lens, task) {
        const due = task.dueDate;
        if (!due) return "UNKNOWN";
        if (lens === "year") return String(YEAR);
        if (lens === "half") return halfOfDate(due);
        if (lens === "quarter") return quarterOfDate(due);
        if (lens === "month") return monthKey(due);
        if (lens === "week") {
          // ì›”-ì£¼ì°¨ ê¸°ë°˜ ê°€ë…ì„± ìš°ì„ : "Feb W2" ê·¸ëŒ€ë¡œ ì‚¬ìš©
          return task.dueLabel || `W${isoWeek(due)}`;
        }
        return "ALL";
      }
      function lensLabel(lens, key) {
        if (lens === "year") return `${key}ë…„`;
        if (lens === "half") return key === "H1" ? "ìƒë°˜ê¸°(H1)" : "í•˜ë°˜ê¸°(H2)";
        if (lens === "quarter") return `ë¶„ê¸° ${key}`;
        if (lens === "month") {
          const mm = key.split("-")[1];
          return `${mm}ì›”`;
        }
        if (lens === "week") return key;
        return key;
      }

      /* ===== Toast / Modal (íŒì—… ìµœì†Œí™”) ===== */
      function toast(msg, type = "") {
        const wrap = document.getElementById("toast-wrap");
        const el = document.createElement("div");
        el.className =
          "toast " + (type === "good" ? "good" : type === "bad" ? "bad" : "");
        el.textContent = msg;
        wrap.appendChild(el);
        setTimeout(() => {
          el.style.opacity = "0";
          el.style.transform = "translateY(6px)";
        }, 2200);
        setTimeout(() => {
          el.remove();
        }, 3000);
      }
      function openPwModal(onOk) {
        const bd = document.getElementById("pw-backdrop");
        const inp = document.getElementById("pw-input");
        const ok = document.getElementById("pw-ok");
        const cancel = document.getElementById("pw-cancel");

        function close() {
          bd.style.display = "none";
          inp.value = "";
          ok.onclick = null;
          cancel.onclick = null;
          bd.onclick = null;
          inp.onkeydown = null;
        }

        bd.style.display = "flex";
        inp.focus();

        ok.onclick = () => {
          onOk(inp.value);
          close();
        };
        cancel.onclick = () => {
          close();
        };

        bd.onclick = (e) => {
          if (e.target === bd) close();
        };

        inp.onkeydown = (e) => {
          if (e.key === "Enter") {
            onOk(inp.value);
            close();
          }
          if (e.key === "Escape") {
            close();
          }
        };
      }

      /* =========================================================
   1) Data (default) + persistence
========================================================= */
      const DEFAULT_DATA = {
        kpiSnapshot: [
          {
            name: "Vent ë°ì´í„° ì´ìƒì¹˜ ê²€ì¦",
            progress: 20,
            due: "May",
            owner: "ì„¸ë¸Œë€ìŠ¤",
            color: "var(--data)",
            note: "ëª©í‘œ: ~5ì›”",
          },
          {
            name: "PRO ì„¤ë¬¸ ë°ì´í„° ê²€ì¦",
            progress: 10,
            due: "Jun",
            owner: "ì„¸ë¸Œë€ìŠ¤Â·AITRICS",
            color: "var(--svc)",
            note: "ëª©í‘œ: ~6ì›”",
          },
          {
            name: "ì•…í™”/ì´ìƒ ì‹œê·¸ë„ ë ˆì´ë¸”ë§",
            progress: 0,
            due: "May",
            owner: "ì„¸ë¸Œë€ìŠ¤",
            color: "var(--ai)",
            note: "ëª©í‘œ: ~5ì›”",
          },
        ],
        roadmap: [
          {
            dept: "ë°ì´í„°/ì¸í”„ë¼ ì—°ê³„",
            color: "var(--data)",
            category: "DATA PIPELINE",
            tasks: [
              {
                id: "D-1.1",
                text: "GPU ì„œë²„ ë° ì›Œí¬ìŠ¤í…Œì´ì…˜ ì¸í”„ë¼ êµ¬ì¶•",
                out: "ì„¤ì¹˜ê³µë¬¸",
                checked: true,
                dueLabel: "Feb W1",
                steps: [
                  { week: "W1", label: "ì„œë²„ ì…ê³  í™•ì¸" },
                  { week: "W1", label: "OS/ë“œë¼ì´ë²„ ì„¸íŒ…" },
                  { week: "W2", label: "ì›ë‚´ ë„¤íŠ¸ì›Œí¬/ë°©í™”ë²½ ì—°ê³„" },
                ],
              },
              {
                id: "D-1.2",
                text: "EMR/MDIP ë°ì´í„° ì—°ê³„ í™•ì¸",
                out: "ì ‘ê·¼ê¶Œí•œ",
                checked: true,
                dueLabel: "Feb W2",
                steps: [
                  { week: "W2", label: "EMR í…Œì´ë¸”Â·ë³€ìˆ˜ ë§µí•‘" },
                  { week: "W3", label: "MDIP ì—°ë™ ì¸í„°í˜ì´ìŠ¤ í…ŒìŠ¤íŠ¸" },
                  { week: "W3", label: "ì¶”ì¶œ ë¡œê·¸/ì—ëŸ¬ì½”ë“œ í‘œì¤€í™”" },
                ],
              },
              {
                id: "D-1.3",
                text: "T-Bridge ë°ì´í„° ì¸í„°í˜ì´ìŠ¤ ì„¤ê³„",
                out: "API_Spec",
                checked: false,
                dueLabel: "Mar W4",
                steps: [
                  { week: "W1", label: "ì¥ë¹„ ì‹ í˜¸ ìˆ˜ì§‘ ê·œê²© ì •ì˜" },
                  { week: "W3", label: "ìŠ¤íŠ¸ë¦¬ë°/ë°°ì¹˜ API ì„¤ê³„" },
                  { week: "W4", label: "ì—ëŸ¬Â·ì¬ì „ì†¡Â·ëˆ„ë½ ì²˜ë¦¬ ì •ì˜" },
                ],
              },
              {
                id: "D-1.4",
                text: "ì´ìƒì¹˜/ê²°ì¸¡ ì²˜ë¦¬ ë° ìˆ˜ì§‘ íŒŒì´í”„ë¼ì¸ ê°œë°œ",
                out: "Pipeline",
                checked: false,
                dueLabel: "May W4",
                steps: [
                  { week: "W2", label: "ê²°ì¸¡ì¹˜ ì²˜ë¦¬ ê·œì¹™/ë³´ê°„ ì •ì±…" },
                  { week: "W3", label: "ì´ìƒì¹˜ ì •ì˜Â·í”Œë˜ê·¸ ì²´ê³„" },
                  { week: "W4", label: "íŒŒì´í”„ë¼ì¸ ì„±ëŠ¥/ì¬í˜„ì„± ìµœì í™”" },
                ],
              },
            ],
          },
          {
            dept: "AI ì•Œê³ ë¦¬ì¦˜ ê°œë°œ",
            color: "var(--ai)",
            category: "AI MODELING",
            tasks: [
              {
                id: "A-2.1",
                text: "ì•…í™”/ì´ìƒ ì‹œê·¸ë„ ë ˆì´ë¸”ë§ ê¸°ì¤€ ìˆ˜ë¦½",
                out: "Label_Guide",
                checked: false,
                dueLabel: "Mar W2",
                steps: [
                  { week: "W1", label: "ì˜ë£Œì§„ í•©ì˜ ê¸°ì¤€ ì´ˆì•ˆ" },
                  { week: "W2", label: "ë ˆì´ë¸”ë§ ë„êµ¬/ì›Œí¬í”Œë¡œìš° ê²°ì •" },
                  { week: "W2", label: "ì¼ì¹˜ë„(IAA) ì ê²€ ì„¤ê³„" },
                ],
              },
              {
                id: "A-2.2",
                text: "Vent ì›ì²œë°ì´í„° ìƒ˜í”Œ EDA ë° íŠ¹ì§•ì •ì˜",
                out: "EDA_Report",
                checked: false,
                dueLabel: "Mar W4",
                steps: [
                  { week: "W2", label: "ì‹ í˜¸ í’ˆì§ˆ ë¶„í¬/ê²°ì¸¡ íŒ¨í„´ ë¶„ì„" },
                  { week: "W3", label: "ì„ìƒ ì´ë²¤íŠ¸ í›„ë³´ í”¼ì²˜ ì •ì˜" },
                  { week: "W4", label: "ëª¨ë¸ ì…ë ¥ í…ì„œ ìŠ¤í™ í™•ì •" },
                ],
              },
              {
                id: "A-2.3",
                text: "Transformer ê¸°ë°˜ ì‹œê³„ì—´ ëª¨ë¸ + Agent êµ¬ì¡° ì„¤ê³„",
                out: "Arch_v1",
                checked: false,
                dueLabel: "May W2",
                steps: [
                  { week: "W2", label: "ì‹œê³„ì—´ ëª¨ë¸ baseline ì •ì˜" },
                  { week: "W3", label: "Agent I/OÂ·ë¡œê·¸ ìŠ¤í‚¤ë§ˆ" },
                  { week: "W4", label: "ì„ê³„ì¹˜/ë¶ˆí™•ì‹¤ì„± ì²˜ë¦¬ ë£°" },
                ],
              },
            ],
          },
          {
            dept: "ì„œë¹„ìŠ¤ ê°œë°œ/êµ¬í˜„",
            color: "var(--svc)",
            category: "SERVICE/UX",
            tasks: [
              {
                id: "P-3.1",
                text: "ë³´í˜¸ì ì¸í„°ë·° ë° ë‹ˆì¦ˆ ë¶„ì„(íŠ¸ë¦¬ì•„ì œ 3ë‹¨ê³„ í¬í•¨)",
                out: "FGI_Report",
                checked: false,
                dueLabel: "Mar W4",
                steps: [
                  { week: "W2", label: "ëŒ€ìƒì ì„ ì •/ë™ì˜ ì ˆì°¨ ì •ë¦¬" },
                  { week: "W4", label: "FGI ìˆ˜í–‰Â·í˜ì¸í¬ì¸íŠ¸ ë„ì¶œ" },
                ],
              },
              {
                id: "P-3.2",
                text: "íŠ¸ë¦¬ì•„ì œ 3ë‹¨ê³„ ë¶„ê¸°(ì‘ê¸‰/ë‹¹ì¼/ëª¨ë‹ˆí„°) UX ë¬¸êµ¬ ì„¤ê³„",
                out: "Flowchart",
                checked: false,
                dueLabel: "Apr W4",
                steps: [
                  { week: "W2", label: "ë¶„ê¸° íŠ¸ë¦¬(ë³´ìˆ˜ì ) ì´ˆì•ˆ" },
                  { week: "W3", label: "ì˜ë£Œì§„ ë¬¸êµ¬/ê¸ˆì¹™ì–´ ê²€ìˆ˜" },
                  { week: "W4", label: "ì‚¬ìš©ì í•©ì„± ì‹œë‚˜ë¦¬ì˜¤ ì‘ì„±" },
                ],
              },
              {
                id: "P-3.3",
                text: "UI ê¸°íš ë° PRO í•­ëª©/ì£¼ê¸° ì„¤ê³„",
                out: "Figma",
                checked: false,
                dueLabel: "May W4",
                steps: [
                  { week: "W2", label: "í™”ë©´ íë¦„ë„(Wireframe) ì‘ì„±" },
                  { week: "W3", label: "PRO ë¬¸í•­Â·ì…ë ¥ì£¼ê¸°(ë¶€ë‹´) ì„¤ê³„" },
                  { week: "W4", label: "Figma ìƒì„¸ í”„ë¡œí† íƒ€ì…" },
                ],
              },
            ],
          },
          {
            dept: "ì¸í—ˆê°€/í’ˆì§ˆ(RA/QA)",
            color: "var(--reg)",
            category: "REGULATORY",
            tasks: [
              {
                id: "R-4.1",
                text: "SaMD ì‚¬ì „ìƒë‹´(ì˜ë„ëœ ì‚¬ìš©Â·ë“±ê¸‰Â·ê¸°ëŠ¥ë¶„ë¦¬) íŒ¨í‚¤ì§€",
                out: "Q&A_Doc",
                checked: false,
                dueLabel: "Mar W4",
                steps: [
                  { week: "W2", label: "ì˜ë„ëœ ì‚¬ìš©/ì‚¬ìš©ì/ì¶œë ¥ ë¬¸êµ¬ í™•ì •" },
                  { week: "W3", label: "ê¸°ëŠ¥ë¶„ë¦¬ ì‹œë‚˜ë¦¬ì˜¤Â·ë¦¬ìŠ¤í¬ ìš”ì•½" },
                  { week: "W4", label: "íšŒì˜ ìˆ˜í–‰Â·í•©ì˜ì‚¬í•­ ê¸°ë¡" },
                ],
              },
              {
                id: "R-4.2",
                text: "SW ìˆ˜ëª…ì£¼ê¸°Â·ì¶”ì ì„±Â·ì‹œí—˜ì „ëµ ë¬¸ì„œí™”",
                out: "Dev_QMS",
                checked: false,
                dueLabel: "Jun W4",
                steps: [
                  { week: "W2", label: "ìš”êµ¬ì‚¬í•­-ì„¤ê³„-ì‹œí—˜ ì¶”ì ì„± í…œí”Œë¦¿" },
                  { week: "W3", label: "V&V(ê²€ì¦/ìœ íš¨ì„±) ê³„íš" },
                  { week: "W4", label: "ë¦´ë¦¬ì¦ˆ/ë³€ê²½ê´€ë¦¬ ì ˆì°¨" },
                ],
              },
              {
                id: "R-4.3",
                text: "ê¸°ìˆ ë¬¸ì„œ íŒ¨í‚¤ì§•(ì„±ëŠ¥Â·ìœ„í—˜ê´€ë¦¬Â·ì‚¬ìš©ì í•©ì„±) ì´ˆì•ˆ",
                out: "Tech_File",
                checked: false,
                dueLabel: "Dec W2",
                steps: [
                  { week: "W1", label: "ì„±ëŠ¥í‰ê°€ ê²°ê³¼ì„œ í†µí•©" },
                  { week: "W2", label: "ìœ„í—˜ê´€ë¦¬Â·ë¼ë²¨ë§Â·ê°€ë“œë ˆì¼ ê·¼ê±° ì •ë¦¬" },
                ],
              },
            ],
          },
        ],
      };

      function loadData() {
        try {
          const raw = localStorage.getItem(STORAGE_KEY);
          if (!raw) return structuredClone(DEFAULT_DATA);
          const parsed = JSON.parse(raw);
          return parsed;
        } catch (e) {
          return structuredClone(DEFAULT_DATA);
        }
      }
      function saveData() {
        localStorage.setItem(STORAGE_KEY, JSON.stringify(DATA));
      }

      /* =========================================================
   2) State
========================================================= */
      let DATA = loadData();
      let editMode = false;

      let lens = "year"; // year | half | quarter | month | week
      let periodKey = String(YEAR);
      let statusFilter = "all"; // all | open | done
      let searchQuery = "";
      let deptFilter = new Set(); // empty means all

      /* âœ… Macro timeline view state (ALL/H1/H2/Q1~Q4) */
      let macroView = "ALL";

      /* =========================================================
   2.1) Macro Timeline Model (ìœ„ ì½”ë“œ ì•„ì´ë””ì–´ ê²°í•©)
========================================================= */
      const macroMonths = [
        "02",
        "03",
        "04",
        "05",
        "06",
        "07",
        "08",
        "09",
        "10",
        "11",
        "12",
      ]; // 11 slots
      const macroMeta = {
        fullUnits: macroMonths.length,
        ranges: {
          ALL: { start: 0, end: 11, label: "ALL" },
          H1: { start: 0, end: 6, label: "H1" }, // 02-07
          H2: { start: 6, end: 11, label: "H2" }, // 08-12
          Q1: { start: 0, end: 3, label: "Q1" }, // 02-04
          Q2: { start: 3, end: 6, label: "Q2" }, // 05-07
          Q3: { start: 6, end: 9, label: "Q3" }, // 08-10
          Q4: { start: 9, end: 11, label: "Q4" }, // 11-12
        },
      };

      const macroRows = [
        {
          key: "DATA PIPELINE",
          color: "var(--data)",
          bars: [
            {
              leftPct: 0,
              widthPct: 36,
              bg: "var(--data)",
              label: "INFRA Â· T-Bridge/EMR/MDIP ì—°ê³„",
            },
          ],
          milestones: [
            { leftPct: 0, label: "ğŸš© ì¸í”„ë¼ ì„¤ì¹˜", color: "var(--reg)" },
            { leftPct: 27, label: "ğŸš© íŒŒì´í”„ë¼ì¸ 1ì°¨", color: "var(--reg)" },
          ],
        },
        {
          key: "AI MODELING",
          color: "var(--ai)",
          bars: [
            {
              leftPct: 9,
              widthPct: 36,
              bg: "var(--ai)",
              label: "Transformer ì‹œê³„ì—´ Â· Agent ì„¤ê³„/ë³´ì •",
            },
          ],
          milestones: [
            { leftPct: 36, label: "ğŸš© ë‚´ë¶€ê²€ì¦ v1", color: "var(--ai)" },
          ],
        },
        {
          key: "SERVICE/UX",
          color: "var(--svc)",
          bars: [
            {
              leftPct: 0,
              widthPct: 63,
              bg: "var(--svc)",
              label: "ë³´í˜¸ì ì•± Â· ì˜ë£Œì§„ UI Â· ìš”ì•½/ê°€ì´ë“œ",
            },
          ],
          milestones: [
            { leftPct: 45, label: "ğŸš© PRO ê²€ì¦", color: "var(--svc)" },
          ],
        },
        {
          key: "REGULATORY",
          color: "var(--reg)",
          bars: [
            {
              leftPct: 9,
              widthPct: 90,
              bg: "var(--reg)",
              label: "SaMD ì œì¶œìë£Œ íŒ¨í‚¤ì§€ Â· ê¸°ëŠ¥ë¶„ë¦¬ ì „ëµ",
            },
          ],
          milestones: [
            { leftPct: 18, label: "ğŸš© ì‚¬ì „ìƒë‹´", color: "var(--reg)" },
            { leftPct: 81, label: "ğŸš© ì œì¶œë³¸ ë™ê²°", color: "var(--reg)" },
          ],
        },
      ];

      function projectBarToVisible(bar) {
        const full = macroMeta.fullUnits;
        const r = macroMeta.ranges[macroView] || macroMeta.ranges.ALL;
        const vSpan = r.end - r.start;

        const startU = (bar.leftPct / 100) * full;
        const endU = startU + (bar.widthPct / 100) * full;

        const isUStart = Math.max(startU, r.start);
        const isUEnd = Math.min(endU, r.end);

        if (isUEnd <= isUStart) return null;

        const leftPct = ((isUStart - r.start) / vSpan) * 100;
        const widthPct = ((isUEnd - isUStart) / vSpan) * 100;
        return { leftPct, widthPct };
      }
      function projectMilestoneToVisible(ms) {
        const full = macroMeta.fullUnits;
        const r = macroMeta.ranges[macroView] || macroMeta.ranges.ALL;
        const vSpan = r.end - r.start;

        const posU = (ms.leftPct / 100) * full;
        if (posU < r.start || posU > r.end) return null;

        const leftPct = ((posU - r.start) / vSpan) * 100;
        return { leftPct };
      }
      function renderMacroTimeline() {
        const r = macroMeta.ranges[macroView] || macroMeta.ranges.ALL;
        const visibleMonths = macroMonths.slice(r.start, r.end);
        const c = visibleMonths.length;

        const headerQuarterRow = (() => {
          if (macroView === "ALL") {
            return `<tr>
        <th rowspan="2" style="width:160px;">KPI CATEGORY</th>
        <th colspan="3" class="quarter-label">Q1</th>
        <th colspan="3" class="quarter-label">Q2</th>
        <th colspan="3" class="quarter-label">Q3</th>
        <th colspan="2" class="quarter-label">Q4</th>
      </tr>`;
          }
          if (macroView === "H1") {
            return `<tr>
        <th rowspan="2" style="width:160px;">KPI CATEGORY</th>
        <th colspan="3" class="quarter-label">Q1</th>
        <th colspan="3" class="quarter-label">Q2</th>
      </tr>`;
          }
          if (macroView === "H2") {
            return `<tr>
        <th rowspan="2" style="width:160px;">KPI CATEGORY</th>
        <th colspan="3" class="quarter-label">Q3</th>
        <th colspan="2" class="quarter-label">Q4</th>
      </tr>`;
          }
          // quarter view
          return `<tr>
      <th rowspan="2" style="width:160px;">KPI CATEGORY</th>
      <th colspan="${c}" class="quarter-label">${macroView}</th>
    </tr>`;
        })();

        const headerMonthRow = `<tr>${visibleMonths.map((m) => `<th>${m}</th>`).join("")}</tr>`;

        const body = macroRows
          .map((row) => {
            const barsHtml = (row.bars || [])
              .map((b) => {
                const p = projectBarToVisible(b);
                if (!p) return "";
                return `<div class="bar" style="width:${p.widthPct}%;background:${b.bg};left:${p.leftPct}%;">${b.label}</div>`;
              })
              .join("");

            const msHtml = (row.milestones || [])
              .map((ms) => {
                const p = projectMilestoneToVisible(ms);
                if (!p) return "";
                const col = ms.color || "var(--reg)";
                return `<div class="milestone" style="left:${p.leftPct}%; color:${col}; border-left-color:${col};">${ms.label}</div>`;
              })
              .join("");

            return `<tr>
      <td style="font-size:11px;font-weight:900;padding-left:14px;color:${row.color};">${row.key}</td>
      <td colspan="${c}">
        ${barsHtml}
        ${msHtml}
      </td>
    </tr>`;
          })
          .join("");

        const table = `<table class="gantt-table">
    <thead>
      ${headerQuarterRow}
      ${headerMonthRow}
    </thead>
    <tbody>${body}</tbody>
  </table>`;

        document.getElementById("macro-timeline").innerHTML = table;
        document.getElementById("macro-view-badge").textContent =
          `TIMELINE: ${r.label}`;
      }

      /* =========================================================
   3) Due hydration
========================================================= */
      function hydrateDueDates() {
        DATA.roadmap.forEach((g) => {
          g.tasks.forEach((t) => {
            const d = dueLabelToDate(t.dueLabel);
            t.dueDate = d ? fmtDate(d) : null;
          });
        });
      }
      hydrateDueDates();

      /* =========================================================
   4) Time scope helpers (í˜„ì¬ ì„ íƒ ë Œì¦ˆ/ê¸°ê°„ ê¸°ì¤€)
========================================================= */
      function taskInCurrentScope(task) {
        const d = task.dueDate
          ? parseYMD(task.dueDate)
          : task.dueLabel
            ? dueLabelToDate(task.dueLabel)
            : null;
        if (!d) return false;
        const k = lensKey(lens, { dueDate: d, dueLabel: task.dueLabel });
        return k === periodKey;
      }

      /* =========================================================
   5) Rendering: KPI / Overview / Total
========================================================= */
      function renderKPI() {
        const wrap = document.getElementById("kpi-grid");
        wrap.innerHTML = "";
        DATA.kpiSnapshot.forEach((k) => {
          const el = document.createElement("div");
          el.className = "kpi";
          const p = clamp(Number(k.progress) || 0, 0, 100);
          el.innerHTML = `
      <div class="k-top">
        <div class="k-name ${editMode ? "editable" : ""}" data-edit="kpi-name">${k.name}</div>
        <div class="k-meta">
          <span class="${editMode ? "editable" : ""}" data-edit="kpi-progress">${p}%</span><br/>
          <span style="color:var(--text-s)" class="${editMode ? "editable" : ""}" data-edit="kpi-owner">${k.owner}</span>
        </div>
      </div>
      <div class="k-bar"><div class="k-fill" style="width:${p}%; background:${k.color};"></div></div>
      <div class="k-foot">
        <span class="pill">DUE: <span class="${editMode ? "editable" : ""}" data-edit="kpi-due">${k.due}</span></span>
        <span class="pill ${editMode ? "editable" : ""}" data-edit="kpi-note">${k.note}</span>
      </div>
    `;
          wrap.appendChild(el);
        });

        if (editMode) {
          wrap.querySelectorAll("[data-edit]").forEach((node) => {
            node.contentEditable = "true";
            node.setAttribute("contenteditable", "true");
          });
        }
      }

      function renderOverview() {
        const grid = document.getElementById("overview-grid");
        grid.innerHTML = "";

        const catOrder = [
          "DATA PIPELINE",
          "AI MODELING",
          "SERVICE/UX",
          "REGULATORY",
        ];
        const catColor = {
          "DATA PIPELINE": "var(--data)",
          "AI MODELING": "var(--ai)",
          "SERVICE/UX": "var(--svc)",
          REGULATORY: "var(--reg)",
        };
        const cats = {};
        catOrder.forEach((c) => (cats[c] = { done: 0, total: 0 }));

        // âœ… í˜„ì¬ ì„ íƒëœ ê¸°ê°„(ë Œì¦ˆ/ê¸°ê°„) ë²”ìœ„ë¡œ ì§‘ê³„
        DATA.roadmap.forEach((g) => {
          g.tasks.forEach((t) => {
            if (!taskInCurrentScope(t)) return;
            if (!cats[g.category]) cats[g.category] = { done: 0, total: 0 };
            cats[g.category].total += 1;
            if (t.checked) cats[g.category].done += 1;
          });
        });

        catOrder.forEach((c) => {
          const done = cats[c].done,
            total = cats[c].total;
          const pct = total ? Math.round((done / total) * 100) : 0;
          const el = document.createElement("div");
          el.className = "p-card";
          el.innerHTML = `
      <div class="p-top">
        <div class="p-name">${c}</div>
        <div class="p-meta">${pct}%<br/><span>${done}/${total}</span></div>
      </div>
      <div class="p-bar"><div class="p-fill" style="width:${pct}%; background:${catColor[c]};"></div></div>
      <div class="p-foot">
        <span class="pill">SCOPE: ${lensLabel(lens, periodKey)}</span>
        <span class="pill">YEAR: 2026</span>
      </div>
    `;
          grid.appendChild(el);
        });
      }

      function renderTotal() {
        let total = 0,
          done = 0;
        DATA.roadmap.forEach((g) => {
          g.tasks.forEach((t) => {
            if (!taskInCurrentScope(t)) return;
            total += 1;
            if (t.checked) done += 1;
          });
        });
        document.getElementById("total-val").innerText = total
          ? Math.round((done / total) * 100) + "%"
          : "0%";
        document.getElementById("total-scope").textContent =
          `SCOPE: ${lensLabel(lens, periodKey)}`;
      }

      /* =========================================================
   6) Filters: lens/period/dept/status/search
========================================================= */
      function getAllTasksFlat() {
        const list = [];
        DATA.roadmap.forEach((g) => {
          g.tasks.forEach((t) =>
            list.push({
              ...t,
              _dept: g.dept,
              _color: g.color,
              _category: g.category,
            }),
          );
        });
        return list;
      }

      function buildPeriods() {
        // period options depend on lens
        const tasks = getAllTasksFlat();
        const keys = new Set();
        tasks.forEach((t) => {
          const d = t.dueDate ? parseYMD(t.dueDate) : null;
          t._dueObj = d;
          const key = lensKey(lens, {
            dueDate: d,
            dueLabel: t.dueLabel,
          });
          keys.add(key);
        });

        let list = Array.from(keys);
        // normalize order
        if (lens === "year") {
          list = [String(YEAR)];
        } else if (lens === "half") {
          list = ["H1", "H2"].filter((k) => keys.has(k));
        } else if (lens === "quarter") {
          list = ["Q1", "Q2", "Q3", "Q4"].filter((k) => keys.has(k));
        } else if (lens === "month") {
          list.sort(); // YYYY-MM ascending
        } else if (lens === "week") {
          // sort by dueDate if possible, fallback label
          list.sort((a, b) => {
            const da = dueLabelToDate(a);
            const db = dueLabelToDate(b);
            if (da && db) return da - db;
            return String(a).localeCompare(String(b));
          });
        }
        const sel = document.getElementById("period-select");
        sel.innerHTML = "";
        list.forEach((k) => {
          const opt = document.createElement("option");
          opt.value = k;
          opt.textContent = lensLabel(lens, k);
          sel.appendChild(opt);
        });

        // keep current periodKey if valid else set first
        if (!list.includes(periodKey)) periodKey = list[0] || String(YEAR);
        sel.value = periodKey;

        // date badge
        const badge = document.getElementById("date-badge");
        badge.textContent = `TODAY: ${fmtDate(new Date())}`;
      }

      function renderDeptChips() {
        const wrap = document.getElementById("dept-chips");
        wrap.innerHTML = "";
        const depts = DATA.roadmap.map((g) => g.dept);

        // "ì „ì²´" chip
        const allChip = document.createElement("div");
        allChip.className = "chip " + (deptFilter.size === 0 ? "on" : "");
        allChip.textContent = "ì „ì²´";
        allChip.onclick = () => {
          deptFilter.clear();
          renderAll();
        };
        wrap.appendChild(allChip);

        depts.forEach((d) => {
          const chip = document.createElement("div");
          chip.className = "chip " + (deptFilter.has(d) ? "on" : "");
          chip.textContent = d;
          chip.onclick = () => {
            if (deptFilter.has(d)) deptFilter.delete(d);
            else deptFilter.add(d);
            renderAll();
          };
          wrap.appendChild(chip);
        });
      }

      function passesFilters(task, group) {
        // dept
        if (deptFilter.size > 0 && !deptFilter.has(group.dept)) return false;

        // status
        if (statusFilter === "open" && task.checked) return false;
        if (statusFilter === "done" && !task.checked) return false;

        // search
        if (searchQuery) {
          const hay =
            `${task.id} ${task.text} ${task.out} ${task.dueLabel}`.toLowerCase();
          if (!hay.includes(searchQuery.toLowerCase())) return false;
        }

        // lens period
        const d = task.dueDate
          ? parseYMD(task.dueDate)
          : task.dueLabel
            ? dueLabelToDate(task.dueLabel)
            : null;
        const key = lensKey(lens, { dueDate: d, dueLabel: task.dueLabel });
        if (key !== periodKey) return false;

        return true;
      }

      /* =========================================================
   7) Render WBS table (one row per task)
========================================================= */
      function renderWBS() {
        const body = document.getElementById("wbs-body");
        body.innerHTML = "";

        let visibleCount = 0;

        DATA.roadmap.forEach((g, gIdx) => {
          const filteredTasks = g.tasks.filter((t) => passesFilters(t, g));
          if (filteredTasks.length === 0) return;

          // dept header row
          const trh = document.createElement("tr");
          trh.className = "dept-row";
          trh.innerHTML = `
      <td colspan="6">
        <span class="dept-tag" style="background:${g.color};">DEPT</span>
        ${g.dept}
        <span class="badge" style="margin-left:8px;">${g.category}</span>
      </td>
    `;
          body.appendChild(trh);

          filteredTasks.forEach((t) => {
            visibleCount++;

            const dueObj = t.dueDate
              ? parseYMD(t.dueDate)
              : t.dueLabel
                ? dueLabelToDate(t.dueLabel)
                : null;
            const dday = dDayString(dueObj);
            const dueDateStr = dueObj ? fmtDate(dueObj) : "UNKNOWN";

            const tr = document.createElement("tr");
            if (t.checked) tr.classList.add("doneRow");

            // steps lines (âœ… index ë¶€ì—¬: ë™ì¼ week ë‹¤ì¤‘ stepë„ ì •í™•íˆ í¸ì§‘)
            const stepsHtml = (t.steps || [])
              .map(
                (s, sIdx) => `
        <div class="stepline">
          <span class="wtag">${s.week}</span>
          <span class="${editMode ? "editable" : ""}"
                data-role="step"
                data-g="${gIdx}"
                data-id="${t.id}"
                data-step-idx="${sIdx}">${s.label}</span>
        </div>
      `,
              )
              .join("");

            tr.innerHTML = `
        <td>
          <input class="cb" type="checkbox" ${t.checked ? "checked" : ""} data-g="${gIdx}" data-tid="${t.id}">
        </td>
        <td class="idcell mono" style="color:${g.color}; font-weight:900;">
          <span class="${editMode ? "editable" : ""}" data-role="id" data-g="${gIdx}" data-id="${t.id}">${t.id}</span>
        </td>
        <td>
          <div class="${t.checked ? "doneText" : ""} ${editMode ? "editable" : ""}"
               data-role="text"
               data-g="${gIdx}"
               data-id="${t.id}"
               style="font-weight:900;">${t.text}</div>
          <div class="editHint">í¸ì§‘ ëª¨ë“œ: í…ìŠ¤íŠ¸ í´ë¦­ í›„ ìˆ˜ì • ê°€ëŠ¥</div>
        </td>
        <td class="steps">
          ${stepsHtml || `<span style="color:var(--text-s)">-</span>`}
        </td>
        <td>
          <span class="duetag">${dday}</span>
          <span class="duemeta">
            <span class="${editMode ? "editable" : ""}" data-role="dueLabel" data-g="${gIdx}" data-id="${t.id}">${t.dueLabel || "-"}</span>
            Â· <span class="mono">${dueDateStr}</span>
          </span>
        </td>
        <td>
          <span class="outtag ${editMode ? "editable" : ""}" data-role="out" data-g="${gIdx}" data-id="${t.id}">${t.out || "-"}</span>
        </td>
      `;
            body.appendChild(tr);
          });
        });

        const countBadge = document.getElementById("count-badge");
        countBadge.textContent = `${visibleCount} items`;

        // bind checkbox changes (row click í† ê¸€ ì œê±°: í´ë¦­ ìµœì†Œ/ì˜¤ë™ì‘ ë°©ì§€)
        body.querySelectorAll("input.cb").forEach((cb) => {
          cb.onchange = () => {
            const gIdx = Number(cb.dataset.g);
            const id = cb.dataset.tid;
            const task = DATA.roadmap[gIdx].tasks.find((x) => x.id === id);
            if (!task) return;
            task.checked = cb.checked;
            hydrateDueDates();
            renderAll();
          };
        });

        // edit mode binding
        body.querySelectorAll("[data-role]").forEach((node) => {
          const role = node.dataset.role;
          node.contentEditable = editMode ? "true" : "false";
          node.setAttribute("contenteditable", editMode ? "true" : "false");
          if (editMode) {
            node.classList.add("editable");
            node.onblur = () => applyEdit(node, role);
          } else {
            node.classList.remove("editable");
            node.onblur = null;
          }
        });

        // show edit hints only in edit mode
        body.querySelectorAll(".editHint").forEach((n) => {
          n.style.display = editMode ? "block" : "none";
        });
      }

      function applyEdit(node, role) {
        const gIdx = Number(node.dataset.g);
        const id = node.dataset.id;
        const group = DATA.roadmap[gIdx];
        if (!group) return;
        const task = group.tasks.find((x) => x.id === id);
        if (!task) return;

        const val = node.textContent.trim();

        if (role === "text") {
          task.text = val || task.text;
        } else if (role === "out") {
          task.out = val || task.out;
        } else if (role === "dueLabel") {
          task.dueLabel = val || task.dueLabel;
        } else if (role === "step") {
          const idx = Number(node.dataset.stepIdx ?? node.dataset["step-idx"]);
          const sIdx = Number.isFinite(idx)
            ? idx
            : Number(node.dataset.stepIdx);
          if (Number.isFinite(sIdx) && task.steps && task.steps[sIdx]) {
            task.steps[sIdx].label = val || task.steps[sIdx].label;
          }
        } else if (role === "id") {
          // ID ë³€ê²½ì€ ì°¸ì¡° ê¹¨ì§ˆ ìˆ˜ ìˆì–´ ì œí•œ: í¸ì§‘ì€ ê°€ëŠ¥í•˜ë˜ ì¤‘ë³µ/ë¹ˆê°’ì´ë©´ ë°˜ì˜ ì•ˆí•¨
          if (val && val !== task.id) {
            const exists = group.tasks.some((x) => x.id === val);
            if (!exists) task.id = val;
            else node.textContent = task.id;
          }
        }

        hydrateDueDates();
        renderAll(false); // no scroll jump
      }

      /* =========================================================
   8) Macro <-> WBS sync
========================================================= */
      function setLensButtonsActive() {
        document.querySelectorAll(".seg button").forEach((b) => {
          b.classList.toggle("active", b.dataset.lens === lens);
        });
      }
      function setMacroChipsActive() {
        document.querySelectorAll("#macro-chips .chip").forEach((ch) => {
          ch.classList.toggle("on", ch.dataset.macro === macroView);
        });
      }

      function syncMacroFromLens() {
        // lensê°€ year/half/quarterì¼ ë•Œë§Œ ìë™ ë™ê¸°í™”
        if (lens === "year") {
          macroView = "ALL";
        } else if (lens === "half") {
          if (periodKey === "H1" || periodKey === "H2") macroView = periodKey;
        } else if (lens === "quarter") {
          if (["Q1", "Q2", "Q3", "Q4"].includes(periodKey))
            macroView = periodKey;
        }
        setMacroChipsActive();
      }

      function applyMacroView(view) {
        macroView = view;
        setMacroChipsActive();

        // âœ… Macro ì„ íƒ ì‹œ WBS ë Œì¦ˆ/ê¸°ê°„ë„ ìë™ ë™ê¸°í™”
        if (view === "ALL") {
          lens = "year";
          periodKey = String(YEAR);
        } else if (view === "H1" || view === "H2") {
          lens = "half";
          periodKey = view;
        } else if (["Q1", "Q2", "Q3", "Q4"].includes(view)) {
          lens = "quarter";
          periodKey = view;
        }

        setLensButtonsActive();
        buildPeriods();
        document.getElementById("period-select").value = periodKey;

        renderAll(false);
      }

      /* =========================================================
   9) Controls
========================================================= */
      function initControls() {
        // lens buttons
        document.querySelectorAll(".seg button").forEach((btn) => {
          btn.onclick = () => {
            lens = btn.dataset.lens;
            setLensButtonsActive();
            buildPeriods();
            syncMacroFromLens();
            renderAll();
          };
        });

        // period select
        const ps = document.getElementById("period-select");
        ps.onchange = () => {
          periodKey = ps.value;
          syncMacroFromLens();
          renderAll();
        };

        // status select
        const ss = document.getElementById("status-select");
        ss.onchange = () => {
          statusFilter = ss.value;
          renderAll();
        };

        // search
        const si = document.getElementById("search-input");
        si.oninput = () => {
          searchQuery = si.value || "";
          renderAll();
        };

        // macro chips
        document.querySelectorAll("#macro-chips .chip").forEach((ch) => {
          ch.onclick = () => applyMacroView(ch.dataset.macro);
        });

        // edit controls
        const editBtn = document.getElementById("edit-btn");
        const saveBtn = document.getElementById("save-btn");
        const exitBtn = document.getElementById("exit-btn");
        const badge = document.getElementById("edit-badge");

        editBtn.onclick = () => {
          openPwModal((pw) => {
            if (pw !== EDIT_PASSWORD) {
              toast("ë¹„ë°€ë²ˆí˜¸ ë¶ˆì¼ì¹˜", "bad");
              return;
            }
            editMode = true;
            badge.textContent = "EDITING";
            badge.classList.add("on");
            editBtn.style.display = "none";
            saveBtn.style.display = "inline-block";
            exitBtn.style.display = "inline-block";
            toast("í¸ì§‘ ëª¨ë“œ í™œì„±í™”", "good");
            renderAll();
          });
        };

        saveBtn.onclick = () => {
          saveData();
          toast("ì €ì¥ ì™„ë£Œ (ë¸Œë¼ìš°ì € ë¡œì»¬ ì €ì¥)", "good");
        };

        exitBtn.onclick = () => {
          editMode = false;
          badge.textContent = "READ-ONLY";
          badge.classList.remove("on");
          editBtn.style.display = "inline-block";
          saveBtn.style.display = "none";
          exitBtn.style.display = "none";
          toast("í¸ì§‘ ëª¨ë“œ ì¢…ë£Œ", "");
          renderAll();
        };
      }

      /* =========================================================
   10) Render all
========================================================= */
      function renderAll(rebuildPeriods = true) {
        hydrateDueDates();
        if (rebuildPeriods) buildPeriods();

        renderDeptChips();
        renderKPI();

        // âœ… Macro timeline + totals/overview are scope-aware
        renderMacroTimeline();
        renderTotal();
        renderOverview();

        renderWBS();
      }

      /* =========================================================
   Boot
========================================================= */
      initControls();
      buildPeriods();
      syncMacroFromLens();
      setLensButtonsActive();
      setMacroChipsActive();
      renderAll();

      /* default lens period selection */
      document.getElementById("period-select").value = periodKey;
    </script>
  </body>
</html>
